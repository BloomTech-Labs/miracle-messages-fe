{"version":3,"sources":["../source/Tooltip.js"],"names":["PureComponent","Component","Tooltip","state","show","isShown","animate","hide_timeout","clearTimeout","undefined","tooltip","classList","remove","create_tooltip","setState","calculate_coordinates","x","y","style","left","top","add","hide","hidingAnimationDuration","props","setTimeout","destroy_tooltip","on_mouse_enter_tooltip","mobile","cancelHide","on_mouse_leave_tooltip","scheduleHide","on_mouse_enter","content","createPortal","show_timeout","delay","on_mouse_leave","on_touch_start","storeOriginNode","ref","origin","tooltipClassName","placement","document","createElement","position","getEdge","split","className","addEventListener","container","appendChild","hide_on_mouse_leave_timeout","parentNode","removeChild","width","offsetWidth","height","offsetHeight","getSide","fitOnScreen","hideTimeout","window","rruiCollapseOnFocusOut","Fragment","_render","extraChildren","inline","children","inline_style","propTypes","oneOf","isRequired","node","bool","number","func","object","string","defaultProps","body","minimal_margin","innerWidth","pageYOffset","innerHeight","display","dashIndex","indexOf","slice","length"],"mappings":"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","file":"Tooltip.js","sourcesContent":["import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\nimport { getOffset } from './utility/dom'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\n// https://github.com/Dogfalo/materialize/blob/master/js/tooltip.js\r\nexport default class Tooltip extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// Tooltip placement.\r\n\t\tplacement : PropTypes.oneOf([\r\n\t\t\t'top',\r\n\t\t\t'top-start',\r\n\t\t\t'top-end',\r\n\t\t\t'left',\r\n\t\t\t'left-start',\r\n\t\t\t'left-end',\r\n\t\t\t'bottom',\r\n\t\t\t'bottom-start',\r\n\t\t\t'bottom-end',\r\n\t\t\t'right',\r\n\t\t\t'right-start',\r\n\t\t\t'right-end'\r\n\t\t]).isRequired,\r\n\r\n\t\t// Tooltip content.\r\n\t\tcontent : PropTypes.node,\r\n\r\n\t\t// Whether this element should be displayed as `inline-block`.\r\n\t\t// (is `true` by default)\r\n\t\tinline : PropTypes.bool.isRequired,\r\n\r\n\t\t// The delay before the tooltip is shown (in milliseconds)\r\n\t\tdelay : PropTypes.number.isRequired,\r\n\r\n\t\t// The duration of the tooltip hiding animation.\r\n\t\t// The DOM element will retain `display: block` for this time period.\r\n\t\t// When changing this timeout also change `transition` time for\r\n\t\t// `.tooltip--after-show` and `.tooltip--before-hide` CSS classes.\r\n\t\t// Is `120` by default.\r\n\t\thidingAnimationDuration : PropTypes.number.isRequired,\r\n\r\n\t\t// The tooltip waits `hideTimeout` milliseconds before hiding\r\n\t\t// to support mouseovering over itself.\r\n\t\thideTimeout : PropTypes.number.isRequired,\r\n\r\n\t\t// `container: () => DOMElement` property is optional\r\n\t\t// and is gonna be the parent DOM Element for the tooltip itself\r\n\t\t// (`document.body` by default).\r\n\t\t// (in which case make sure that `document.body` has no `margin`\r\n\t\t//  otherwise tooltip `left` and `top` positions will be slightly off).\r\n\t\tcontainer : PropTypes.func,\r\n\r\n\t\t// CSS style object\r\n\t\tstyle : PropTypes.object,\r\n\r\n\t\t// CSS class name\r\n\t\tclassName : PropTypes.string,\r\n\r\n\t\t// Tooltip CSS class name\r\n\t\ttooltipClassName : PropTypes.string\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\tplacement: 'top',\r\n\t\tinline: true,\r\n\t\tdelay: 350, // in milliseconds\r\n\t\thidingAnimationDuration: 200, // in milliseconds\r\n\t\thideTimeout: 50, // in milliseconds\r\n\t\tcontainer: () => document.body\r\n\t}\r\n\r\n\tstate = {}\r\n\r\n\t// componentDidMount()\r\n\t// {\r\n\t// \tthis.create_tooltip()\r\n\t// }\r\n\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tthis.destroy_tooltip()\r\n\t}\r\n\r\n\tcreate_tooltip()\r\n\t{\r\n\t\tconst { tooltipClassName, placement } = this.props\r\n\r\n\t\tthis.tooltip = document.createElement('div')\r\n\r\n\t\tthis.tooltip.style.position = 'absolute'\r\n\t\tthis.tooltip.style.left = 0\r\n\t\tthis.tooltip.style.top  = 0\r\n\r\n\t\tthis.tooltip.classList.add('rrui__tooltip')\r\n\t\tthis.tooltip.classList.add(`rrui__tooltip--${getEdge(placement)}`)\r\n\r\n\t\tif (tooltipClassName) {\r\n\t\t\tfor (const className of tooltipClassName.split(/\\s+/)) {\r\n\t\t\t\tthis.tooltip.classList.add(className)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.tooltip.addEventListener('mouseenter', this.on_mouse_enter_tooltip)\r\n\t\tthis.tooltip.addEventListener('mouseleave', this.on_mouse_leave_tooltip)\r\n\r\n\t\tthis.container().appendChild(this.tooltip)\r\n\t}\r\n\r\n\tdestroy_tooltip()\r\n\t{\r\n\t\tclearTimeout(this.show_timeout)\r\n\t\tclearTimeout(this.hide_timeout)\r\n\t\tclearTimeout(this.hide_on_mouse_leave_timeout)\r\n\r\n\t\tif (this.tooltip)\r\n\t\t{\r\n\t\t\t// Won't throw an exception\r\n\t\t\tthis.tooltip.parentNode.removeChild(this.tooltip)\r\n\t\t\tthis.tooltip = undefined\r\n\t\t}\r\n\t}\r\n\r\n\tcontainer()\r\n\t{\r\n\t\tconst { container } = this.props\r\n\t\treturn container()\r\n\t}\r\n\r\n\tcalculate_coordinates()\r\n\t{\r\n\t\tconst { placement } = this.props\r\n\r\n\t\tconst width  = this.tooltip.offsetWidth\r\n\t\tconst height = this.tooltip.offsetHeight\r\n\r\n\t\tconst origin = getOffset(this.origin)\r\n\r\n\t\tlet top\r\n\t\tlet left\r\n\r\n\t\tswitch (getEdge(placement)) {\r\n\t\t\tcase 'top':\r\n\t\t\t\ttop = origin.top - height\r\n\t\t\t\tbreak\r\n\t\t\tcase 'bottom':\r\n\t\t\t\ttop = origin.top + origin.height\r\n\t\t\t\tbreak\r\n\t\t\tcase 'left':\r\n\t\t\t\tleft = origin.left - width\r\n\t\t\t\tbreak\r\n\t\t\tcase 'right':\r\n\t\t\t\tleft = origin.left + origin.width\r\n\t\t\t\tbreak\r\n\t\t}\r\n\r\n\t\tswitch (getEdge(placement)) {\r\n\t\t\tcase 'top':\r\n\t\t\tcase 'bottom':\r\n\t\t\t\tswitch (getSide(placement)) {\r\n\t\t\t\t\tcase 'start':\r\n\t\t\t\t\t\tleft = origin.left\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'end':\r\n\t\t\t\t\t\tleft = origin.left + origin.width - width\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t// Default: \"center\".\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tleft = origin.left + (origin.width - width) / 2\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t\tcase 'left':\r\n\t\t\tcase 'right':\r\n\t\t\t\tswitch (getSide(placement)) {\r\n\t\t\t\t\tcase 'start':\r\n\t\t\t\t\t\ttop = origin.top\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase 'end':\r\n\t\t\t\t\t\ttop = origin.top + origin.height - height\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t// Default: \"center\".\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\ttop = origin.top + (origin.height - height) / 2\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t\tbreak\r\n\t\t}\r\n\r\n\t\treturn fitOnScreen(\r\n\t\t\tleft,\r\n\t\t\ttop - getOffset(this.container()).top,\r\n\t\t\twidth,\r\n\t\t\theight\r\n\t\t)\r\n\t}\r\n\r\n\tshow = () =>\r\n\t{\r\n\t\tthis.isShown = true\r\n\r\n\t\t// Play tooltip showing animation\r\n\t\tlet animate = false\r\n\r\n\t\t// If hiding animation is being played,\r\n\t\t// then cancel it, and cancel setting\r\n\t\t// `display` to `none` after it finishes playing.\r\n\t\tif (this.hide_timeout)\r\n\t\t{\r\n\t\t\tclearTimeout(this.hide_timeout)\r\n\t\t\tthis.hide_timeout = undefined\r\n\r\n\t\t\t// Abort tooltip hiding animation.\r\n\t\t\t// It will automatically return to the \"showing\" state.\r\n\t\t\tthis.tooltip.classList.remove('rrui__tooltip--before-hide')\r\n\t\t}\r\n\t\t// Otherwise, the tooltip is hidden (or never been shown)\r\n\t\telse\r\n\t\t{\r\n\t\t\t// Not creating in `componentDidMount()`\r\n\t\t\t// therefore create it here.\r\n\t\t\tif (!this.tooltip)\r\n\t\t\t{\r\n\t\t\t\tthis.create_tooltip()\r\n\t\t\t}\r\n\r\n\t\t\t// Play tooltip showing animation\r\n\t\t\tanimate = true\r\n\t\t}\r\n\r\n\t\t// Now that `this.tooltip` has been created,\r\n\t\t// re-render the component so that `ReactDOM.createPortal()` is called.\r\n\t\tthis.setState({ isShown: true }, () =>\r\n\t\t{\r\n\t\t\tconst { x, y } = this.calculate_coordinates()\r\n\r\n\t\t\tthis.tooltip.style.left = `${x}px`\r\n\t\t\tthis.tooltip.style.top  = `${y}px`\r\n\r\n\t\t\t// Play tooltip showing animation\r\n\t\t\t// (doing it after setting position because\r\n\t\t\t//  setting position applies `display: block`)\r\n\t\t\tif (animate)\r\n\t\t\t{\r\n\t\t\t\tthis.tooltip.classList.add('rrui__tooltip--after-show')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\thide = () =>\r\n\t{\r\n\t\tthis.isShown = false\r\n\r\n\t\tconst { hidingAnimationDuration } = this.props\r\n\r\n\t\t// If already hiding, or if already hidden, then do nothing.\r\n\t\t// if (this.hide_timeout || this.tooltip.style.display === 'none')\r\n\t\tif (this.hide_timeout || !this.tooltip)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Play tooltip hiding animation\r\n\t\tthis.tooltip.classList.add('rrui__tooltip--before-hide')\r\n\r\n\t\t// Set the tooltip to `display: none`\r\n\t\t// after its hiding animation finishes.\r\n\t\tthis.hide_timeout = setTimeout(() =>\r\n\t\t{\r\n\t\t\tthis.hide_timeout = undefined\r\n\t\t\tthis.destroy_tooltip()\r\n\t\t\tthis.setState({ isShown: false })\r\n\t\t},\r\n\t\thidingAnimationDuration)\r\n\t}\r\n\r\n\tscheduleHide() {\r\n\t\tconst { hideTimeout } = this.props\r\n\t\t// `window.rruiCollapseOnFocusOut` can be used\r\n\t\t// for debugging expandable contents.\r\n\t\tif (window.rruiCollapseOnFocusOut !== false) {\r\n\t\t\tthis.hide_on_mouse_leave_timeout = setTimeout(this.hide, hideTimeout)\r\n\t\t}\r\n\t}\r\n\r\n\tcancelHide() {\r\n\t\tclearTimeout(this.hide_on_mouse_leave_timeout)\r\n\t\tthis.hide_on_mouse_leave_timeout = undefined\r\n\t}\r\n\r\n\ton_mouse_enter_tooltip = () =>\r\n\t{\r\n\t\t// mouse enter and mouse leave events\r\n\t\t// are triggered on mobile devices too\r\n\t\tif (this.mobile) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (this.isShown) {\r\n\t\t\tthis.cancelHide()\r\n\t\t}\r\n\t}\r\n\r\n\ton_mouse_leave_tooltip = () =>\r\n\t{\r\n\t\t// mouse enter and mouse leave events\r\n\t\t// are triggered on mobile devices too\r\n\t\tif (this.mobile) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (this.isShown) {\r\n\t\t\tthis.scheduleHide()\r\n\t\t}\r\n\t}\r\n\r\n\ton_mouse_enter = () =>\r\n\t{\r\n\t\tconst { content } = this.props\r\n\r\n\t\t// mouse enter and mouse leave events\r\n\t\t// are triggered on mobile devices too\r\n\t\tif (this.mobile) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tif (this.isShown) {\r\n\t\t\treturn this.cancelHide()\r\n\t\t}\r\n\r\n\t\t// If the tooltip has no content\r\n\t\t// (e.g. `react-time-ago` first render)\r\n\t\t// or if React Portal API is not available\r\n\t\t// then don't show the tooltip.\r\n\t\tif (!content || !ReactDOM.createPortal) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Shouldn't happen, because\r\n\t\t// `mouse leave` event clears this timeout.\r\n\t\tif (this.show_timeout) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst { delay } = this.props\r\n\r\n\t\t// Don't show the tooltip immediately\r\n\t\t// but rather wait for the user to\r\n\t\t// \"mouse over\" it for a short time interval.\r\n\t\t// (prevents false positives)\r\n\t\tthis.show_timeout = setTimeout(() => {\r\n\t\t\tthis.show_timeout = undefined\r\n\t\t\tthis.show()\r\n\t\t},\r\n\t\tdelay)\r\n\t}\r\n\r\n\ton_mouse_leave = () =>\r\n\t{\r\n\t\t// mouse enter and mouse leave events\r\n\t\t// are triggered on mobile devices too\r\n\t\tif (this.mobile) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// If tooltip hasn't been shown yet,\r\n\t\t// then cancel showing it.\r\n\t\tif (this.show_timeout) {\r\n\t\t\tclearTimeout(this.show_timeout)\r\n\t\t\tthis.show_timeout = undefined\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// Otherwise, the tooltip is shown, so hide it.\r\n\t\tif (this.isShown) {\r\n\t\t\tthis.scheduleHide()\r\n\t\t}\r\n\t}\r\n\r\n\ton_touch_start = () =>\r\n\t{\r\n\t\tconst { content } = this.props\r\n\r\n\t\t// mouse enter events won't be processed from now on\r\n\t\tthis.mobile = true\r\n\r\n\t\t// If the tooltip has no content\r\n\t\t// (e.g. `react-time-ago` first render)\r\n\t\t// or if React Portal API is not available\r\n\t\t// then don't show the tooltip.\r\n\t\tif (!content || !ReactDOM.createPortal)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.show()\r\n\t}\r\n\r\n\tstoreOriginNode = (ref) => this.origin = ref\r\n\r\n\trender()\r\n\t{\r\n\t\t// Shows tooltip on mouse over when on desktop.\r\n\t\t// Shows tooltip on touch when on mobile.\r\n\r\n\t\tconst\r\n\t\t{\r\n\t\t\tcontent\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\t// `ReactDOM.createPortal()` requires React >= 16.\r\n\t\t// If it's not available then it won't show the tooltip.\r\n\r\n\t\tconst tooltip = this.tooltip && content && ReactDOM.createPortal && ReactDOM.createPortal(content, this.tooltip)\r\n\r\n\t\t// For React >= 16.2.\r\n\t\t// Disable React portal event bubbling.\r\n\t\t// https://github.com/facebook/react/issues/11387#issuecomment-340019419\r\n\t\tif (React.Fragment) {\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t{this._render()}\r\n\t\t\t\t\t{tooltip}\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\t// Legacy version support.\r\n\t\t\t// Can be a bit buggy in some rare cases of mouseentering and mouseleaving.\r\n\t\t\t// Will be removed in some future major version release.\r\n\t\t\treturn this._render(tooltip)\r\n\t\t}\r\n\t}\r\n\r\n\t_render(extraChildren) {\r\n\t\tconst\r\n\t\t{\r\n\t\t\tinline,\r\n\t\t\tstyle,\r\n\t\t\tclassName,\r\n\t\t\tchildren\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tref={ this.storeOriginNode }\r\n\t\t\t\tonMouseEnter={ this.on_mouse_enter }\r\n\t\t\t\tonMouseLeave={ this.on_mouse_leave }\r\n\t\t\t\tonTouchStart={ this.on_touch_start }\r\n\t\t\t\tonTouchMove={ this.hide }\r\n\t\t\t\tonTouchEnd={ this.hide }\r\n\t\t\t\tonTouchCancel={ this.hide }\r\n\t\t\t\tstyle={ inline ? (style ? { ...inline_style, ...style } : inline_style) : style }\r\n\t\t\t\tclassName={ classNames('rrui__tooltip__target', className) }>\r\n\t\t\t\t{ children }\r\n\t\t\t\t{ extraChildren }\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nfunction fitOnScreen(x, y, width, height)\r\n{\r\n\tconst minimal_margin = 4 // in pixels\r\n\r\n\tif (x < minimal_margin)\r\n\t{\r\n\t\tx = minimal_margin\r\n\t}\r\n\telse if (x + width + minimal_margin > window.innerWidth)\r\n\t{\r\n\t\tx -= (x + width + minimal_margin) - window.innerWidth\r\n\t}\r\n\r\n\tif (y < window.pageYOffset + minimal_margin)\r\n\t{\r\n\t\ty = window.pageYOffset + minimal_margin\r\n\t}\r\n\telse if (y + height + minimal_margin > window.pageYOffset + window.innerHeight)\r\n\t{\r\n\t\ty -= (y + height + minimal_margin) - (window.pageYOffset + window.innerHeight)\r\n\t}\r\n\r\n\treturn { x, y }\r\n}\r\n\r\nconst inline_style =\r\n{\r\n\tdisplay : 'inline-block'\r\n}\r\n\r\n/**\r\n * @param  {string} placement\r\n * @return {string} One of: \"top\", \"right\", \"bottom\", \"left\".\r\n */\r\nfunction getEdge(placement) {\r\n\tconst dashIndex = placement.indexOf('-')\r\n\tif (dashIndex >= 0) {\r\n\t\treturn placement.slice(0, dashIndex)\r\n\t}\r\n\treturn placement\r\n}\r\n\r\n/**\r\n * @param  {string} placement\r\n * @return {string} One of: \"start\", \"center\", \"end\".\r\n */\r\nfunction getSide(placement) {\r\n\tconst dashIndex = placement.indexOf('-')\r\n\tif (dashIndex >= 0) {\r\n\t\treturn placement.slice(dashIndex + '-'.length)\r\n\t}\r\n\treturn 'center'\r\n}"]}