{"version":3,"sources":["../source/DragAndDrop.js"],"names":["getFilesFromEvent","CanDrop","DragAndDrop","DropFiles","node","createRef","dragTargets","setDraggedOver","draggedOver","props","onDragOver","event","preventDefault","stopPropagation","onDragEnter","indexOf","target","push","isDraggingFiles","onDragLeave","filter","_","current","contains","length","onDrop","multiple","accept","files","acceptedFiles","isFileAccepted","rejectedFiles","isAccepted","file","type","div","addEventListener","removeEventListener","rest","createElement","ref","Component","propTypes","func","isRequired","bool","string","dataTransfer","Array","prototype","some","call","types","dataTransferItemsList","dt","items","slice","drop","Error","File","Files","FILE","FILES"],"mappings":"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","file":"DragAndDrop.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport isFileAccepted from './utility/isFileAccepted'\r\n\r\nexport class DropFiles extends React.Component {\r\n\tstatic propTypes = {\r\n\t\t// Will be called with `true` when the drop zone is dragged over.\r\n\t\t// (and with `false` when it's no longer dragged over)\r\n\t\tsetDraggedOver: PropTypes.func,\r\n\t\t// Will be called on file(s) drop.\r\n\t\t// The argument will be the single file when `multiple` is `false` (default)\r\n\t\t// or the array of files when `multiple` is `true`.\r\n\t\tonDrop: PropTypes.func.isRequired,\r\n\t\t// Set to `true` for multi-file drop.\r\n\t\tmultiple: PropTypes.bool,\r\n\t\t// Can be used to restrict the file MIME-types or extensions available for selection.\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#attr-accept\r\n\t\taccept: PropTypes.string\r\n\t}\r\n\r\n\t// state = {\r\n\t// \tisDragging: false\r\n\t// }\r\n\r\n\tnode = React.createRef()\r\n\r\n\t// Copied from:\r\n\t// https://github.com/react-dropzone/react-dropzone/blob/master/src/index.js\r\n\tdragTargets = []\r\n\r\n\tsetDraggedOver = (draggedOver) => {\r\n\t\tconst { setDraggedOver } = this.props\r\n\t\tif (setDraggedOver) {\r\n\t\t\tsetDraggedOver(draggedOver)\r\n\t\t}\r\n\t}\r\n\r\n\t// Must be `preventDefault`-ed for some weird reasons.\r\n\tonDragOver = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\t}\r\n\r\n\t// `event` is always triggered when gragging from another window to the browser window.\r\n\tonDragEnter = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\r\n\t\t// Copied from:\r\n\t\t// https://github.com/react-dropzone/react-dropzone/blob/master/src/index.js\r\n\t\t// Count the dropzone and any children that are entered.\r\n\t\tif (this.dragTargets.indexOf(event.target) === -1) {\r\n\t\t\tthis.dragTargets.push(event.target)\r\n\t\t}\r\n\r\n\t\t// `event.dataTransfer.files` are only accessible on \"drop\" event.\r\n\t\t// `event.dataTransfer.items` are only accessible in Chrome and FireFox while dragging.\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/items\r\n\t\tif (isDraggingFiles(event)) {\r\n\t\t\t// Filtering dragged files by `isFileAccepted`.\r\n\t\t\t// Only MIME-types are available during the \"drag\" stage,\r\n\t\t\t// not file extensions. And won't work in IE11.\r\n\t\t\t// // IE11 does not support dataTransfer.items\r\n\t\t\t// if (event.dataTransfer.items) {\r\n\t\t\t// \t// Only MIME-types are available for `isFileAccepted`\r\n\t\t\t// \t// filtering during the \"drag\" stage, not file extensions.\r\n\t\t\t// \t// `.some` is supported starting from IE 9.\r\n\t\t\t// \tconst areAnyFilesAccepted = Array.prototype.some.call(\r\n\t\t\t// \t\tevent.dataTransfer.items,\r\n\t\t\t// \t\tthis.isFileAccepted\r\n\t\t\t// \t)\r\n\t\t\t// \tif (!areAnyFilesAccepted) {\r\n\t\t\t// \t\treturn\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\tthis.setDraggedOver(true)\r\n\t\t}\r\n\t}\r\n\r\n\tonDragLeave = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\r\n\t\t// Copied from:\r\n\t\t// https://github.com/react-dropzone/react-dropzone/blob/master/src/index.js\r\n\t\t// Only deactivate once the dropzone and all children have been left.\r\n\t\tthis.dragTargets = this.dragTargets.filter(_ => _ !== event.target && this.node.current.contains(_))\r\n\t\tif (this.dragTargets.length > 0) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.setDraggedOver(false)\r\n\t}\r\n\r\n\tonDrop = (event) => {\r\n\t\tconst {\r\n\t\t\tonDrop,\r\n\t\t\tmultiple,\r\n\t\t\taccept\r\n\t\t} = this.props\r\n\r\n\t\tevent.preventDefault()\r\n\t\tevent.stopPropagation()\r\n\r\n\t\t// Reset.\r\n\t\tthis.dragTargets = []\r\n\r\n\t\tthis.setDraggedOver(false)\r\n\r\n\t\tconst files = getFilesFromEvent(event) //.filter(this.isFileAccepted)\r\n\t\tif (files.length > 0) {\r\n\t\t\tif (multiple) {\r\n\t\t\t\tonDrop(files, {\r\n\t\t\t\t\tacceptedFiles: accept ? files.filter(this.isFileAccepted) : files,\r\n\t\t\t\t\trejectedFiles: accept ? files.filter(_ => !this.isFileAccepted(_)) : []\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t// If multiple files have been dropped to a non-multiple drop zone\r\n\t\t\t\t// then reduce the files list to just the first file.\r\n\t\t\t\tonDrop(files[0], {\r\n\t\t\t\t\tisAccepted: this.isFileAccepted(files[0])\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t// Not clear why would it be called.\r\n\t\t\t// MDN says it's a \"no-op\".\r\n\t\t\t// https://developer.mozilla.org/en-US/docs/Web/API/DataTransferItemList/clear\r\n\t\t\t// event.dataTransfer.clearData()\r\n\t\t}\r\n\t}\r\n\r\n\tisFileAccepted = (file) => {\r\n\t\tconst { accept } = this.props\r\n\t\tif (accept) {\r\n\t\t\t// Firefox versions prior to 53 return a bogus MIME type for every file drag, so dragovers with\r\n\t\t\t// that MIME type will always be accepted\r\n\t\t\tif (file.type === 'application/x-moz-file') {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn isFileAccepted(file, accept)\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst div = this.node.current\r\n\t\tdiv.addEventListener('dragenter', this.onDragEnter)\r\n\t\tdiv.addEventListener('dragleave', this.onDragLeave)\r\n\t\tdiv.addEventListener('dragover', this.onDragOver)\r\n\t\tdiv.addEventListener('drop', this.onDrop)\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tconst div = this.node.current\r\n\t\tdiv.removeEventListener('dragenter', this.onDragEnter)\r\n\t\tdiv.removeEventListener('dragleave', this.onDragLeave)\r\n\t\tdiv.removeEventListener('dragover', this.onDragOver)\r\n\t\tdiv.removeEventListener('drop', this.onDrop)\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tonDrop,\r\n\t\t\tsetDraggedOver,\r\n\t\t\tmultiple,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\r\n\t\treturn React.createElement('div', {\r\n\t\t\tref: this.node,\r\n\t\t\t...rest\r\n\t\t})\r\n\t}\r\n}\r\n\r\n// Copied from:\r\n// https://github.com/react-dropzone/react-dropzone/blob/master/src/utils/index.js\r\nfunction isDraggingFiles(event) {\r\n\t// If `event.dataTransfer` is not available then `event.target.files` fallback is used.\r\n\tif (!event.dataTransfer) {\r\n\t\treturn true\r\n\t}\r\n\t// https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/types\r\n\t// https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Recommended_drag_types#file\r\n\t// `.some` is supported starting from IE 9.\r\n\treturn Array.prototype.some.call(\r\n\t\tevent.dataTransfer.types,\r\n\t\ttype => type === 'Files' || type === 'application/x-moz-file'\r\n\t)\r\n}\r\n\r\n// Copied from:\r\n// https://github.com/react-dropzone/react-dropzone/blob/master/src/utils/index.js\r\nexport function getFilesFromEvent(event) {\r\n\tlet dataTransferItemsList = []\r\n\tif (event.dataTransfer) {\r\n\t\tconst dt = event.dataTransfer\r\n\t\t// NOTE: Only the 'drop' event has access to DataTransfer.files,\r\n\t\t// otherwise it will always be empty\r\n\t\tif (dt.files && dt.files.length) {\r\n\t\t\tdataTransferItemsList = dt.files\r\n\t\t} else if (dt.items && dt.items.length) {\r\n\t\t\t// During the drag even the dataTransfer.files is null\r\n\t\t\t// but Chrome implements some drag store, which is accesible via dataTransfer.items\r\n\t\t\tdataTransferItemsList = dt.items\r\n\t\t}\r\n\t} else if (event.target && event.target.files) {\r\n\t\tdataTransferItemsList = event.target.files\r\n\t}\r\n\t// Convert from DataTransferItemsList to the native Array\r\n\treturn Array.prototype.slice.call(dataTransferItemsList)\r\n}\r\n\r\n// // Copied from:\r\n// // https://github.com/react-dropzone/react-dropzone/blob/master/src/utils/index.js\r\n// // Firefox versions prior to 53 return a bogus MIME type for every file drag, so dragovers with\r\n// // that MIME type will always be accepted\r\n// function isFileAccepted(file, accept) {\r\n// \treturn this.props.isFileAccepted(file) || (file.type === 'application/x-moz-file' || this.props.isFileTypeAccepted(file))\r\n// }\r\n\r\n// Deprecated.\r\nexport function CanDrop(type, drop)\r\n{\r\n\tthrow new Error('`react-dnd` has been removed from `react-responsive-ui` starting from version `0.14.124` due to being buggy and not supported. `react-dnd` has been replaced with simple native HTML file drag-n-drop. Use `<DropFileUpload/>` and `<DropMultiFileUpload/>` components for file upload instead of `DragAndDrop` and `CanDrop` decorators.')\r\n}\r\n\r\n// Deprecated.\r\nexport function DragAndDrop()\r\n{\r\n\tthrow new Error('`react-dnd` has been removed from `react-responsive-ui` starting from version `0.14.124` due to being buggy and not supported. `react-dnd` has been replaced with simple native HTML file drag-n-drop. `DragAndDrop` decorator is no longer needed and should be removed. Use `<DropFileUpload/>` and `<DropMultiFileUpload/>` components for file upload.')\r\n}\r\n\r\n// Deprecated.\r\n// Native file drag'n'drop (single file)\r\nexport const File = 'File'\r\n\r\n// Deprecated.\r\n// Native file drag'n'drop (multiple files)\r\nexport const Files = 'Files'\r\n\r\n// Deprecated.\r\n// Native file drag'n'drop (single file)\r\nexport const FILE = File\r\n\r\n// Deprecated.\r\n// Native file drag'n'drop (multiple files)\r\nexport const FILES = Files"]}